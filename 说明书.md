# 锚制ИВ-18多功能荧光电子时钟

## 这是什么?

顾名思义, 这是块表(也不仅是).  

拿到这块表, 您第一眼就会看见那根硕大无比的玻璃制管状显示器, 这是一支来自苏联时代, 在乌克兰生产的真空电子荧光显示器(`VFD`), 代号`ИВ-18` (拉丁文转写`IV-18`).  

`ИВ-18`荧光电子数码管, 上世纪80-90年代前苏联的产物, 得益于其远超半导体设备的稳定性(比如抗核辐射), 冷战时期曾被大量制造并用于军事设备; 苏联解体后, 同其他海量的战争遗物一起, 被或埋于地下, 或被尘封在冰冷的仓库角落.  

随着毛子老哥不断翻找, 这些设备又出现在了市场上, 流到了国内, 我斥~~巨~~资(每根110元, 不算邮费)买了(当时)淘宝上仅剩的两支回来, 其中一支做了这块表, 另一支做了另一块表.  

同国产YS-13/18以及同家族的ИВ-11等不同的是, 她一根管内嵌入了8个7段数字, 并且每个数字右下角都有小数点, 在管子的左侧, 还有一个表示负数的短横线, 在短横线上面还有一个较大的圆点符号.  

这根管子是1991年12月生产的(管身注明), 可能当时乌克兰应该是已经不听苏联管了, 管子上没有印制`СССР`的徽标, 非常可惜. 我曾见过苏联较早期(80年代)生产的电子管(也是一种真空电子设备)上印制一个`大`字logo, 下面印着`СССР`的.  

经过约50V的电场加速, 从钍制阴极发射的电子穿过栅极, 打在阳极的氧化锌材料上, 就发出VFD特有的明亮淡绿色荧光.  

这块表的制作历时7个月(2022.1~2022.8), 终于在暑假结束前完成了调试, 我谨以此赠给您以表心意. (本来想您过生日给您的, 结果时间太紧迫没能完成)  

您现在拿到的这块表其实已经是我设计的第二版了, 第一版因为有某些重大设计缺陷而未能使用. 现在应该不会有什么重大问题了, 我把它给您之前已经做了从原型机到成品的打磨, 并且进行了持续大约一周的测试, 没有发现什么进一步的问题.

如果您发现出现了什么故障, 只要不是显示管被打碎了, 都是有希望修复的, 您交给我, 我会尽量尝试修复.

|保修承诺书 |项目       |生产日期   |保修日期   |负责人      |客户       |
|-          |-          |-          |-          |-          |-          |
|           |           |           |           |           |           |

*电路板上印制的日期是电路设计日期和电路板打印日期, 没错, 电路板是打印的.*  
*下面的是电池, 不是炸弹, 虽然让电池爆炸的方法也不是不存在.*  

考虑到真空电子设备寿命不长, 满载运作仅有1万小时左右, 我已经对功率做限制不会满载了, 再结合锂电池的寿命, 让您用到高中毕业还是没什么问题的(大概).  

时钟的精度大概在每年400秒误差之内, 还是可以接受的吧, 高精度的时钟芯片都太贵啦, 可惜计时器也仅能精确到秒而不是毫秒.

写说明书好累啊, 感觉跟别人讲清楚一个东西怎么用, 比把这个东西做出来还要困难呐, 希望我能给您讲清楚吧(逃).  

那就请您认真阅读啦.  

附带的全部资料电子版, 从电路图到我写的的程序源码, 已经打好包了, 如果您需要, 随时可以发给您.  

纸质附件: `ИВ-18`俄文原版说明书, 部分关键技术参考资料.  

## 设计功能

1. 时钟
2. \(秒\)计时器
3. 温度计
4. \(每日\)闹钟
5. \(每日\)定时开关机

## 使用说明

### 电源
主电源由电池经过升压提供`5V`供电.

*使用 `type-c` 接口充放电*.  

经测试, 主电源充满电后可正常使用24小时以上.  
充满电大概需要2小时左右  

充满电后蓝色指示灯亮起,表示电量达到 $80\%$ 以上 ,此时可以停止充电.  

电池有电时, 可以通过充电口(`type-c`)对外提供`5V 1.5A`输出, 可以作为特定条件下的充电宝使用(**但不建议,因为电池容量仅有约`5000mAh`**).

做充电宝用的方法:
> 1. 您需要准备一根type-c公对公线  
> 2. 线一边插到表上, 一边插到手机上  
> 3. 开始充电  

时钟电源由`CR1220`纽扣电池提供, 起到(主电源掉电后)不间断计时的功能, 设计更换时间为**1年** \(**可以自行更换**,小卖铺有卖的\).  

更换时钟电池的方法:
> 1. 确保主电池放电完毕. (可用负载输出的方式加速放电) 
> 2. 用手向外抠一下荧光管下方的棕色电池槽上的铁片, 此时旧电池自动弹出.
> 3. 将新电池小头向电路板按入电池槽, 此时上述铁片自动回到正常位, 锁定电池.
> 4. 充电开机, 重新设置时间.

主电源电池使用寿命, 应该不短于3年.

### 按钮

*共有`4`个按钮在主电路板背向显示器的一面.*  
面对显示器, 用右手可以摸到四个按钮在后面, 从上到下依次为:  
1. `MODE`  
2. `SETTING`  
3. `NEXT`  
4. `UP`  

### 启动
*分为`软启动`和`硬启动`*  

+ 系统`硬启动`\(硬件上电\)后, 蜂鸣器发出短暂声音表示开机, 此时系统自动进入时钟模式.  
+ 系统`软启动`\(启动荧光管\)后, 系统进入时钟模式.  

### 关闭
*分为`软关机`和`硬关机`*  

+ `硬关机`状态指主电源掉电\(电池亏电, 或拔下充电线的一瞬间\).  
+ `软关机`状态指主电源有电但关闭荧光管, 可以由定时开关机控制或者手动进入\(见\"模式\"\).  


### 模式主界面
1. 对于时钟模式, 显示`hh-mm-ss`的界面称为主界面.  
2. 对于计时器模式, 任意状态均视为主界面.
3. 对于温度计模式, 任意状态均视为主界面.  
4. 对于任意设置模式, 显示模式缩写的称为主界面.  
5. 对于软关机状态, 不显示的就是主界面.  

### 模式的切换
在任意模式主界面按下`MODE`按键可切换到下一模式.  
切换时会短暂显示模式缩写.  
切换至最后一个模式后将关闭荧光管\(软关机\).  
在软关机状态切换将进入第一个模式\(时钟模式\)  

### 模式列表以及对应缩写

|模式           |缩写   |
|-              |-      |
|时钟模式       |CLO    |
|计时器模式     |St     |
|温度计模式     |tE     |
|设置时间       |EE     |
|设置亮度       |EL     |
|设置闹钟       |EA     |
|设置定时开关机 |EP     |
|软关机         |\-     |

### 时钟模式
此模式有两种界面,第一种将会持续显示`hh-mm-ss`格式的时间, 单位是`小时`, `分钟`, `秒`.  
在第一种界面按**住**`NEXT`则可以进入第二种模式.  
第二种模式会显示`yyyyMMdd`格式的时间, 单位是`年`, `月`, `日`.  

*时制为24小时*

### 计时器模式
此模式会显示一个整数表示计时器记录的时间\(精确到1秒\).  
进入此模式时会显示`0`.  
+ 按第一次`NEXT`以开始计时.  
+ 按第二次`NEXT`将会停止本次计时.  
+ 按第三次`NEXT`将会清空当前记录的时间.  
+ 再次按下`NEXT`开始下一次计时.  

任意状态按下`MODE`离开计时器, 但是在硬关机前都会持续计时.   

### 温度计模式
此模式会显示传感器附近的温度, 传感器在主电路背面红黑线内侧, 黑色的一小点伸出来两根线的就是它.  
*注意别把传感器弄坏了(物理意义)*  
量程大概在 $-20 \ ^{\circ}C$ 到 $45 \ ^{\circ}C$ 之间.  
过低的温度将会导致未定义的测量值, 而超过 $45 \ ^{\circ}C$ 则有可能永久损坏传感器, 甚至是主控芯片.  
测量精度大概在 $0.5 \ ^{\circ}C$ 左右.  
显示精度为 $0.1$ 单位.  

*单位是可切换的*  

支持显示摄氏度, 华氏度, 热力学温度(开尔文). 

在此模式按下`NEXT`就能切换到其他单位:  
1. 摄氏度, 显示 $C$  
2. 华氏度, 显示 $F$  
3. 热力学温度, 显示 $K$  

*充电的时候温度可能偏高.*

~~因为程序是夏天写的, 我没测试零下的温度显示是否正常, 如果有问题可以给我返修.~~

### 设置时间
进入`设置时间`模式, 此时显示`EE`.  
此时按下`SETTING`以编辑时间.  
编辑界面分为两处, 第一处表示时间, 格式为`hh-mm-ss`, 第二处表示日期, 格式为`yyyyMMdd`.  
每一位均可在十进制范围内\(`0~9`\)编辑.  
按下`NEXT`来选择编辑的下一位\(从右至左\).  
*当前正在编辑的位右下角小数点会闪烁.*  
小数点移动到最左侧之后自动进入另一个界面.  
第二界面会在最左侧点亮圆点.  
对于两个界面的编辑:  
+ 按下`UP`来给当前正在编辑的位加`1`.\(超过`9`自动转为`0`\).  
+ 按下`MODE`退出编辑但不保存.  
+ 按下`SETTINGS`退出编辑并保存.  


### 设置亮度

*由于VFD的物理特性, 其荧光在强日光下可见性较差, 建议在室内使用.*

进入`设置亮度`模式, 此时显示`EL`.  
此时按下`SETTING`以调整亮度.
编辑界面为十进制整数\(`1~25`\).  
仅能编辑这个整体的数, 每次加一.  
按下`UP`来给亮度增加`1`, 超过`25`自动转为`10`.  
按下`MODE`退出编辑但不保存.  
按下`SETTINGS`退出编辑并保存.  

会随时在左侧显示`88-88`作为亮度参考.  

*注意: 过低的亮度可能会导致这个页面某些字符不可见, 这是正常现象, 在时钟模式会正常显示.*  

注意, 这里亮度的设置**仅对于`时钟模式`是有效的**.  
如果真的希望调整全局亮度, 可以使用硬件调光(**不建议**), 请用`小螺丝刀`**小心缓慢地**旋转荧光管旁边电容上方的**蓝色电位器**.  

为什么不建议?  
> 这个我做的时候已经调整过了, 工作在非常良好的状态, 亮度和功耗基本处在平衡状态.

旋转的细节:  
> + 逆时针旋转减小亮度  
> + 顺时针旋转增大亮度  
> + 逆时针可以旋转到不亮为止(不建议更低), 顺时针旋转**务必不能超过默认的位置**, 否则有很大可能烧毁电路.  
> 原因: 调节电位器本质是调节荧光管驱动电路的有效功率, 但有效功率与实际功率在一定范围外不成线性, 实际功率过大将会导致电路烧毁.  
> + 具体做法是, 顺时针旋转电位器的时候, **发现亮度不再增强就立刻停止并逆时针转回去一点**.
> + 如果正常使用过程中(非充电状态)感觉到电容附近温度明显高, 则有可能是实际功率过大, 建议逆时针旋转电位器调整一下.    
> + 务必不要用手摸电路, **也不要让螺丝刀金属部分接触到电路板上任何裸露的金属**, 否则有可能导致短路烧毁电路板, 或者导致触电(满亮度电压约有`50V`). 且电路烧毁将是很难修复的.  


### 设置闹钟

进入`设置闹钟`模式, 此时显示`EA`.  
此时按下`SETTING`以编辑闹钟.  
编辑界面显示`hh-mm-ss`.  
每一位均可在十进制范围内\(0~9\)编辑.  
按下`NEXT`来编辑下一位\(从右至左\).  
*当前正在编辑的位右下角小数点会闪烁.*    
按下`UP`来给当前正在编辑的位加`1`.\(超过`9`自动转为`0`\).  
按下`MODE`退出编辑但不保存.  
按下`SETTINGS`退出编辑并保存.  

*设置闹钟时间为`00-00-00`以关闭闹钟.*  

注意, 软关机状态下闹钟依然会响.  

### 设置定时开关机

进入`设置定时开关机`模式, 此时显示`EP`.  
此时按下`SETTING`以编辑时间.
编辑界面分为两处, 第一处表示**开机时间**, 格式为`hh-mm-ss`, 第二处表示**关机时间**, 格式为`hh-mm-ss`.  
*编辑第二处时左侧圆点亮起以示区分.*  
每一位均可在十进制范围内\(0~9\)编辑.  
按下`NEXT`来编辑下一位\(从右至左\).  
*当前正在编辑的位右下角小数点会闪烁.*  
小数点移动到最左侧之后自动进入另一个界面.  
按下`UP`来给当前正在编辑的位加`1`.\(超过`9`自动转为`0`\).  
按下`MODE`退出编辑但不保存.  
按下`SETTINGS`退出编辑并保存.  

***分别**设置开机或者关机时间为`00-00-00`以关闭定时开关机.*  

### 清洁方式
1. 确定主电源电量**彻底**放完.
2. 用湿巾**轻轻**擦拭玻璃管和亚克力板还有外框不锈钢柱能摸到的地方, 如果不好弄**不要大力**.
3. 不要让湿巾或者什么奇怪的东西接触电路板的任何部分
4. 用卫生纸擦干净玻璃管和亚克力板上的水渍
5. 晾干5分钟